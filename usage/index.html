<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="generator" content="mkdocs-1.6.1, mkdocs-terminal-4.7.0">
     
     
    <link rel="icon" type="image/png" sizes="192x192" href="../img/android-chrome-192x192.png" />
<link rel="icon" type="image/png" sizes="512x512" href="../img/android-chrome-512x512.png" />
<link rel="apple-touch-icon" sizes="180x180" href="../img/apple-touch-icon.png" />
<link rel="shortcut icon" type="image/png" sizes="48x48" href="../img/favicon.ico" />
<link rel="icon" type="image/png" sizes="16x16" href="../img/favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="../img/favicon-32x32.png" />


    
 
<title>Usage - Pocket Flow Framework</title>


<link href="../css/fontawesome/css/fontawesome.min.css" rel="stylesheet">
<link href="../css/fontawesome/css/solid.min.css" rel="stylesheet">
<link href="../css/normalize.css" rel="stylesheet">
<link href="../css/terminal.css" rel="stylesheet">
<link href="../css/theme.css" rel="stylesheet">
<link href="../css/theme.tile_grid.css" rel="stylesheet">
<link href="../css/theme.footer.css" rel="stylesheet">
<!-- default color palette -->
<link href="../css/palettes/default.css" rel="stylesheet">

<!-- page layout -->
<style>
/* initially set page layout to a one column grid */
.terminal-mkdocs-main-grid {
    display: grid;
    grid-column-gap: 1.4em;
    grid-template-columns: auto;
    grid-template-rows: auto;
}

/*  
*   when side navigation is not hidden, use a two column grid.  
*   if the screen is too narrow, fall back to the initial one column grid layout.
*   in this case the main content will be placed under the navigation panel. 
*/
@media only screen and (min-width: 70em) {
    .terminal-mkdocs-main-grid {
        grid-template-columns: 4fr 9fr;
    }
}</style>



     
    
    

    
    <!-- search css support -->
<link href="../css/search/bootstrap-modal.css" rel="stylesheet">
<!-- search scripts -->
<script>
    var base_url = "..",
    shortcuts = "{}";
</script>
<script src="../js/jquery/jquery-1.10.1.min.js" defer></script>
<script src="../js/bootstrap/bootstrap.min.js" defer></script>
<script src="../js/mkdocs/base.js" defer></script>
    
    
    
    
    <script src="../search/main.js"></script>
    

    
</head>

<body class="terminal"><div class="container">
    <div class="terminal-nav">
        <header class="terminal-logo">
            <div id="mkdocs-terminal-site-name" class="logo terminal-prompt"><a href="/" class="no-style">Pocket Flow Framework</a></div>
        </header>
        
        <nav class="terminal-menu">
            
            <ul vocab="https://schema.org/" typeof="BreadcrumbList">
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href=".." class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Home</span>
                    </a>
                    <meta property="position" content="0">
                </li>
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href="../guide/" class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Guide</span>
                    </a>
                    <meta property="position" content="1">
                </li>
                
                
                
                
                
                
                <li property="itemListElement" typeof="ListItem">
                    <a href="../apps/" class="menu-item " property="item" typeof="WebPage">
                        <span property="name">Applications</span>
                    </a>
                    <meta property="position" content="2">
                </li>
                
                    
                    


<li property="itemListElement" typeof="ListItem">
    <a href="#" class="menu-item" data-toggle="modal" data-target="#mkdocs_search_modal" property="item" typeof="SearchAction">
        <i aria-hidden="true" class="fa fa-search"></i> <span property="name">Search</span>
    </a>
    <meta property="position" content="3">
</li>
                    
            </ul>
            
        </nav>
    </div>
</div>
        
    <div class="container">
        <div class="terminal-mkdocs-main-grid"><aside id="terminal-mkdocs-side-panel"><nav>
  
    <ul class="terminal-mkdocs-side-nav-items">
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="..">Home</a>
        
    
    
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../guide/">Guide</a>
        
    
    
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Core Concepts</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../core_abstraction/">Core Abstraction</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../flow/">Understanding Flows</a>
        
    
    </li>
            
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../decomp/">Task Decomposition</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
        
        

        
            
    
        
        
            
            
            <span class="
        
    

    terminal-mkdocs-side-nav-item terminal-mkdocs-side-nav-section-no-index">Implementation</span>
        
    
    
        
      
        
            <ul class="terminal-mkdocs-side-nav-li-ul">
        
            
            

             
                <li class="terminal-mkdocs-side-nav-li-ul-li">
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../preparation/">Setup</a>
        
    
    </li>
            
            
    </ul>
        
    
  </li>
        
          



<li class="terminal-mkdocs-side-nav-li">
    
    
    
        
        
            <a class="

    terminal-mkdocs-side-nav-item" href="../apps/">Applications</a>
        
    
    
    
  </li>
        
    </ul>
  
</nav><hr>
<nav>
    <ul>
        <li><a href="#usage">Usage</a></li>
        <li><a href="#1-install-import">1. Install &amp; Import</a></li><li><a href="#2-create-nodes">2. Create Nodes</a></li><li><a href="#3-connect-nodes-into-a-flow">3. Connect Nodes into a Flow</a></li><li><a href="#4-run-the-flow">4. Run the Flow</a></li><li><a href="#5-handling-multiple-actions">5. Handling Multiple Actions</a></li><li><a href="#6-retrying-error-handling">6. Retrying &amp; Error Handling</a></li><li><a href="#7-async-vs-sync">7. Async vs Sync</a></li><li><a href="#8-example-putting-it-all-together">8. Example: Putting It All Together</a></li><li><a href="#summary">Summary</a></li>
    </ul>
</nav>
</aside>
            <main id="terminal-mkdocs-main-content">
    
    
    
    
    

<section id="mkdocs-terminal-content">
    <h1 id="usage">Usage</h1>
<p>This document demonstrates how to use <strong>pocket.ts</strong> in a typical TypeScript project. You can create <strong>Nodes</strong>, connect them in a <strong>Flow</strong>, and run that Flow with some shared state.</p>
<hr />
<h2 id="1-install-import">1. Install &amp; Import</h2>
<pre><code class="language-bash">npm install pocket-ts
</code></pre>
<p>In your TypeScript code:</p>
<pre><code class="language-typescript">import { BaseNode, Flow, DEFAULT_ACTION } from &quot;pocket-ts&quot;; 
// Adjust import if your local path is different or you have a monorepo structure
</code></pre>
<hr />
<h2 id="2-create-nodes">2. Create Nodes</h2>
<p>A <strong>Node</strong> extends <code>BaseNode</code> (or another node class) and implements any of the following async methods:</p>
<ul>
<li><code>prepAsync(sharedState: any)</code>: Prepare and return data for execution.</li>
<li><code>execAsync(prepResult: any)</code>: Main logic, possibly calling an LLM or API.</li>
<li><code>postAsync(sharedState: any, prepResult: any, execResult: any)</code>: Post-processing (e.g., saving results, deciding next action).</li>
</ul>
<pre><code class="language-typescript">class GreetNode extends BaseNode {
  public async prepAsync(sharedState: any): Promise&lt;string&gt; {
    // Suppose we want to greet a user
    const userName = sharedState.userName ?? &quot;Guest&quot;;
    return userName;
  }

  public async execAsync(userName: string): Promise&lt;string&gt; {
    return `Hello, ${userName}!`;
  }

  public async postAsync(
    sharedState: any,
    prepResult: string,
    execResult: string
  ): Promise&lt;string&gt; {
    sharedState.greeting = execResult;
    console.log(&quot;GreetNode result:&quot;, execResult);
    return DEFAULT_ACTION; // proceed to next node or end if none
  }
}
</code></pre>
<hr />
<h2 id="3-connect-nodes-into-a-flow">3. Connect Nodes into a Flow</h2>
<p>You can chain nodes by specifying how one node transitions to the other. In <code>pocket.ts</code>, you do this via <code>addSuccessor(nextNode, actionString)</code>:</p>
<pre><code class="language-typescript">class AskFavoriteColorNode extends BaseNode {
  // ...
}

class RespondColorNode extends BaseNode {
  // ...
}

// Create instances
const greetNode = new GreetNode();
const askColorNode = new AskFavoriteColorNode();
const respondColorNode = new RespondColorNode();

// Connect
greetNode.addSuccessor(askColorNode, DEFAULT_ACTION);
askColorNode.addSuccessor(respondColorNode, DEFAULT_ACTION);

// Build a Flow that starts with greetNode
const flow = new Flow(greetNode);
</code></pre>
<hr />
<h2 id="4-run-the-flow">4. Run the Flow</h2>
<p>Create a <code>sharedState</code> object and pass it to the Flow's <code>runAsync</code> method:</p>
<pre><code class="language-typescript">(async () =&gt; {
  const shared: any = {
    userName: &quot;Alice&quot;,
  };

  await flow.runAsync(shared);

  // After the flow completes, inspect sharedState
  console.log(&quot;All done! Final shared state:&quot;, shared);
})();
</code></pre>
<hr />
<h2 id="5-handling-multiple-actions">5. Handling Multiple Actions</h2>
<p>Sometimes, you'll want to branch based on different outcomes from a node. Each node's <code>postAsync</code> can return a <strong>string</strong> (often an "Action") which is used to choose the next node.</p>
<pre><code class="language-typescript">class SurveyNode extends BaseNode {
  public async execAsync(_: unknown): Promise&lt;string&gt; {
    const userInput = await this.askQuestion(&quot;Do you like TypeScript? (yes/no)&quot;);
    return userInput.trim().toLowerCase();
  }

  public async postAsync(
    sharedState: any,
    prepResult: unknown,
    userResponse: string
  ): Promise&lt;string&gt; {
    if (userResponse === &quot;yes&quot;) {
      return &quot;yes_action&quot;;
    } else {
      return &quot;no_action&quot;;
    }
  }

  private async askQuestion(question: string): Promise&lt;string&gt; {
    // minimal prompt for demonstration
    // replace with a real I/O method, or an LLM prompt
    return Promise.resolve(&quot;yes&quot;); 
  }
}

// Usage:
//     surveyNode.addSuccessor(yesNode, &quot;yes_action&quot;);
//     surveyNode.addSuccessor(noNode, &quot;no_action&quot;);
</code></pre>
<hr />
<h2 id="6-retrying-error-handling">6. Retrying &amp; Error Handling</h2>
<p><code>BaseNode</code> and its subclasses can optionally accept retry parameters (e.g., <code>maxRetries</code> and <code>wait</code>). If <code>execAsync</code> fails, the node will automatically retry.</p>
<pre><code class="language-typescript">class UnreliableNode extends BaseNode {
  constructor() {
    // e.g., ask for 3 attempts with a 2-second wait
    super({ maxRetries: 3, wait: 2 });
  }

  public async execAsync(_: unknown): Promise&lt;string&gt; {
    if (Math.random() &lt; 0.5) {
      throw new Error(&quot;Random failure!&quot;);
    }
    return &quot;Success this time!&quot;;
  }
}

// If all retries fail, execFallbackAsync is called, if defined.
// If fallback is not defined or rethrows, the flow can fail unless you handle it.
</code></pre>
<hr />
<h2 id="7-async-vs-sync">7. Async vs Sync</h2>
<p>Most LLM-based tasks or external API calls require <strong>async</strong>. With <code>pocket.ts</code>, <code>prepAsync</code>, <code>execAsync</code>, <code>postAsync</code>, and <code>execFallbackAsync</code> can all be asynchronous. You can handle synchronous tasks simply by returning a resolved Promise.</p>
<hr />
<h2 id="8-example-putting-it-all-together">8. Example: Putting It All Together</h2>
<p>Below is a small end-to-end flow:</p>
<pre><code class="language-typescript">import { BaseNode, Flow, DEFAULT_ACTION } from &quot;pocket-ts&quot;;

// Node #1: Greet user
class GreetNode extends BaseNode {
  public async execAsync(_: unknown): Promise&lt;string&gt; {
    return &quot;Hello! What's your name?&quot;;
  }
  public async postAsync(sharedState: any, _: any, greeting: string): Promise&lt;string&gt; {
    console.log(greeting);
    return DEFAULT_ACTION;
  }
}

// Node #2: Get user's name (mock input)
class GetNameNode extends BaseNode {
  public async execAsync(_: unknown): Promise&lt;string&gt; {
    return &quot;Alice&quot;; // In real life, you'd ask or read from user input
  }
  public async postAsync(sharedState: any, _: any, name: string): Promise&lt;string&gt; {
    sharedState.userName = name;
    return DEFAULT_ACTION;
  }
}

// Node #3: Personalize farewell
class FarewellNode extends BaseNode {
  public async execAsync(_: unknown): Promise&lt;string&gt; {
    return &quot;Nice to meet you!&quot;;
  }
  public async postAsync(sharedState: any, _: any, farewell: string): Promise&lt;string&gt; {
    console.log(`${farewell} Goodbye, ${sharedState.userName}!`);
    return DEFAULT_ACTION;
  }
}

// Build flow
const greetNode = new GreetNode();
const nameNode = new GetNameNode();
const farewellNode = new FarewellNode();

greetNode.addSuccessor(nameNode, DEFAULT_ACTION);
nameNode.addSuccessor(farewellNode, DEFAULT_ACTION);

const flow = new Flow(greetNode);

// Run flow
flow.runAsync({}).then(() =&gt; {
  console.log(&quot;Flow complete!&quot;);
});
</code></pre>
<p>Console output might look like:</p>
<pre><code>Hello! What's your name?
Nice to meet you! Goodbye, Alice!
Flow complete!
</code></pre>
<hr />
<h2 id="summary">Summary</h2>
<ul>
<li><strong>Import</strong> <code>BaseNode</code> and <code>Flow</code> from <code>pocket.ts</code>.  </li>
<li><strong>Create</strong> Nodes with <code>prepAsync</code>, <code>execAsync</code>, <code>postAsync</code> as needed.  </li>
<li><strong>Chain</strong> nodes in a Flow and specify actions.  </li>
<li><strong>Run</strong> the flow using <code>runAsync(sharedState)</code>.  </li>
<li>Optionally use features like <strong>retry</strong>, <strong>fallback</strong>, or <strong>action-based branching</strong>.  </li>
</ul>
<p>This is the basic usage pattern for building Node-based flows in <code>pocket.ts</code>. Feel free to explore more advanced features like parallel flows, multi-agent architectures, or specialized node types (batch nodes, etc.). </p>
</section>

<section id="mkdocs-terminal-after-content">
    
</section>

            </main>
        </div>
        <hr><footer>
    <div class="terminal-mkdocs-footer-grid">
        <div id="terminal-mkdocs-footer-copyright-info">
             Site built with <a href="http://www.mkdocs.org">MkDocs</a> and <a href="https://github.com/ntno/mkdocs-terminal">Terminal for MkDocs</a>.
        </div>
    </div>
</footer>
    </div>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="alertdialog" aria-modal="true" aria-labelledby="searchModalLabel">
    <div class="modal-dialog modal-lg" role="search">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">Search</h5>
                <button type="button" class="close btn btn-default btn-ghost" data-dismiss="modal"><span aria-hidden="true">x</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p id="searchInputLabel">Type to start searching</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" aria-labelledby="searchInputLabel" placeholder="" id="mkdocs-search-query" title="Please enter search terms here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No document matches found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    
    
</body>

</html>